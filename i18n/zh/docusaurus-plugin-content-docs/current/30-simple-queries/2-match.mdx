import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# ğŸ‘ $match

$match æ“ä½œç¬¦ä¸èšåˆæ¡†æ¶ä¸€èµ·ä½¿ç”¨ï¼Œç”¨äºè¿‡æ»¤é›†åˆä¸­çš„æ–‡æ¡£ã€‚å®ƒæ¥å—ä¸€ä¸ªæ–‡æ¡£ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°æ–‡æ¡£ï¼Œä»…åŒ…å«ç¬¦åˆæŒ‡å®šæ¡ä»¶çš„æ–‡æ¡£ã€‚$match æ“ä½œç¬¦çš„è¯­æ³•å¦‚ä¸‹ï¼š

```
{ $match: { <expression>: <value> } }
```

## è¡¨è¾¾å¼

$match æ“ä½œç¬¦ä¸­çš„ `<expression>` éƒ¨åˆ†å¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆçš„ MongoDB è¡¨è¾¾å¼ã€‚è¿™åŒ…æ‹¬ï¼š

* æ¯”è¾ƒæ“ä½œç¬¦ï¼š`eq`ã€`neq`ã€`gte`ã€`lte`ã€`gt`ã€`lt`ã€`in`ã€`nin`ã€`exists`
* æ­£åˆ™è¡¨è¾¾å¼ï¼š`regex`
* é€»è¾‘æ“ä½œç¬¦ï¼š`and`ã€`or`ã€`not`
* å­æ–‡æ¡£å’Œæ•°ç»„ï¼š`{ field: <value> }, [ <item>, <item>, ... ]`

## åŒ¹é…ä¹¦ç±æ–‡æ¡£

<Tabs groupId="aggregations-year">
  <TabItem value="atlas" label="Atlas UI">

    é¦–å…ˆï¼Œç¡®ä¿åœ¨ Atlas UI ä¸­é€‰æ‹© `books` é›†åˆã€‚
    <Screenshot src="/img/30-simple-queries/select-books-collection.png" url="http://cloud.mongodb.com/" alt="Atlas UI æ•°æ®åº“éƒ¨ç½²ï¼Œçªå‡ºæ˜¾ç¤º books é›†åˆã€‚" />

    ç„¶åï¼Œå¯¼èˆªåˆ° `Aggregation` é€‰é¡¹å¡å¹¶ç‚¹å‡» `Add Stage`ã€‚
    <Screenshot src="/img/30-simple-queries/new-aggregation.png" url="http://cloud.mongodb.com/" alt="Atlas UI æ•°æ®åº“éƒ¨ç½²ï¼Œçªå‡ºæ˜¾ç¤ºèšåˆé€‰é¡¹å¡ã€‚" />

    å‡è®¾æˆ‘ä»¬æƒ³è¦æ‰€æœ‰ 2010 å¹´çš„ä¹¦ç±ã€‚æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ª `$match` é˜¶æ®µæ¥è¿‡æ»¤ books é›†åˆä¸­çš„æ–‡æ¡£ï¼š

    ```
    [
        {
            $match: { year: 2010 }
        }
    ]
    ```

    <Screenshot src="/img/30-simple-queries/match-screenshot.png" url="http://cloud.mongodb.com/" alt="Atlas AI $match èšåˆã€‚" />

  </TabItem>
  <TabItem value="mongodb-shell" label="MongoDB Shell">
    å‡è®¾æˆ‘ä»¬æƒ³è¦æ‰€æœ‰ 2010 å¹´çš„ä¹¦ç±ã€‚æˆ‘ä»¬ä¼šå†™ï¼š

    ```
    db.books.aggregate([{$match: {year: 2010}}])
    ```
  </TabItem>
</Tabs>

ğŸ‘ è¿”å›æ‰€æœ‰æœ‰æ°å¥½ 100 é¡µçš„ `books`ã€‚

<details>
<summary>ç­”æ¡ˆ</summary>
<div>

<Tabs groupId="aggregations-pages">
  <TabItem value="atlas" label="Atlas UI">
```
[
    {
        $match: { pages: 100 }
    }
]
```

  </TabItem>
  <TabItem value="mongodb-shell" label="MongoDB Shell">
```
db.books.aggregate([{$match: {pages: 100}}])
```
  </TabItem>
</Tabs>

</div>
</details>

## AND

å¦‚æœæˆ‘ä»¬éœ€è¦ä½¿ç”¨ AND æ·»åŠ æ›´å¤šæ¡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ `$and` æ“ä½œç¬¦ã€‚

å¦‚æœæˆ‘ä»¬æƒ³è¦æ‰€æœ‰æœ‰ 100 é¡µå¹¶ä¸” `totalInventory` æ°å¥½ä¸º 2 çš„ä¹¦ç±ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `$and` æ“ä½œç¬¦ã€‚è¿™ä¸ªæ“ä½œç¬¦æ¥å—ä¸€ä¸ªåŒ…å«æ‰€æœ‰æ¡ä»¶çš„æ–‡æ¡£æ•°ç»„ï¼Œè¿™äº›æ¡ä»¶éƒ½å¿…é¡»ä¸ºçœŸï¼ŒAND æ“ä½œæ‰ä¼šæˆåŠŸï¼š

<Tabs groupId="aggregations-and">
  <TabItem value="atlas" label="Atlas UI">
```
[
    {
        $match: {
            $and: [
                { pages: 100 },
                { totalInventory: 2 }
            ]
        }
    }
]
```
  </TabItem>
  <TabItem value="mongodb-shell" label="MongoDB Shell">
```
db.books.aggregate([{$match: {$and: [{pages: 100}, {totalInventory: 2}]}}])
```
  </TabItem>
</Tabs>

ä¼ªä»£ç å¦‚ä¸‹ï¼š
```
IF pages == 100 AND totalInventory == 2 {
return matching docs
}
```

ğŸ‘ è¿”å›æ‰€æœ‰ 2015 å¹´çš„ `books`ï¼Œè¿™äº›ä¹¦ç±æ°å¥½æœ‰ 100 é¡µã€‚

<details>
<summary>ç­”æ¡ˆ</summary>
<div>

<Tabs groupId="aggregations">
  <TabItem value="atlas" label="Atlas UI">
```js
[
    {
        $match: {
            $and: [
                { pages: 100 },
                { year: 2015 }
            ]
        }
    }
]
```
  </TabItem>
  <TabItem value="mongodb-shell" label="MongoDB Shell">
```
db.books.aggregate([{$match: {$and: [{pages: 100}, {year: 2015}]}}])
```
  </TabItem>
</Tabs>

</div>
</details>
ğŸ‘ å®ƒä»¬æœ‰å¤šå°‘ï¼Ÿ

<details>
<summary>ç­”æ¡ˆ</summary>
<div>

<Tabs groupId="aggregations">
  <TabItem value="atlas" label="Atlas UI">
```js
[
    {
        $match: {
            $and: [
                { pages: 100 },
                { year: 2015 }
            ]
        }
    },
    {
        $count: "books_count"
    }
]
```
  </TabItem>
  <TabItem value="mongodb-shell" label="MongoDB Shell">
```js
db.books.aggregate([{$match: {$and: [{pages: 100}, {year: 2015}]}}]).itcount()
```
  </TabItem>
</Tabs>
</div>
</details>

### ç®€å†™ AND

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ é€’åŒ…å«æ‰€æœ‰æ¡ä»¶çš„æ–‡æ¡£æ¥è¿›è¡Œéšå¼ ANDï¼ˆè€Œä¸æ˜¯æ–‡æ¡£æ•°ç»„ï¼‰ï¼š

<Tabs groupId="aggregations-shorthand-and">
  <TabItem value="atlas" label="Atlas UI">
```js
[
    {
        $match: {pages: 100, totalInventory: 2}
    }
]
```
  </TabItem>
  <TabItem value="mongodb-shell" label="MongoDB Shell">
```js
db.books.aggregate([{$match: {pages: 100, totalInventory: 2}}])
```
  </TabItem>
</Tabs>

ğŸ‘ ä½¿ç”¨ç®€å•çš„ $and è¯­æ³•è¿”å›æ‰€æœ‰ 2015 å¹´çš„ `books`ï¼Œè¿™äº›ä¹¦ç±æ°å¥½æœ‰ 100 é¡µ

<details>
<summary>ç­”æ¡ˆ</summary>
<div>

<Tabs groupId="aggregations-shorthand-and-exercise">
  <TabItem value="atlas" label="Atlas UI">
```js
[
    {
        $match: {pages: 100, year: 2015}
    }
]
```
  </TabItem>
  <TabItem value="mongodb-shell" label="MongoDB Shell">
```js
db.books.aggregate([{$match: {pages: 100, year: 2015}}])
```
  </TabItem>
</Tabs>
</div>
</details>